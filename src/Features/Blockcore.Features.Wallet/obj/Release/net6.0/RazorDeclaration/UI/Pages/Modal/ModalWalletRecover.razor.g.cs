// <auto-generated/>
#pragma warning disable 1591
#pragma warning disable 0414
#pragma warning disable 0649
#pragma warning disable 0169

namespace Blockcore.Features.Wallet.UI.Pages.Modal
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Components;
#nullable restore
#line 1 "C:\Users\PC\source\repos\50ti put URIS\src\Features\Blockcore.Features.Wallet\UI\_Imports.razor"
using Microsoft.AspNetCore.Components.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 1 "C:\Users\PC\source\repos\50ti put URIS\src\Features\Blockcore.Features.Wallet\UI\Pages\Modal\ModalWalletRecover.razor"
using Blockcore.Features.Wallet.Interfaces;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "C:\Users\PC\source\repos\50ti put URIS\src\Features\Blockcore.Features.Wallet\UI\Pages\Modal\ModalWalletRecover.razor"
using NBitcoin;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "C:\Users\PC\source\repos\50ti put URIS\src\Features\Blockcore.Features.Wallet\UI\Pages\Modal\ModalWalletRecover.razor"
using Blockcore.Features.Wallet.Api.Controllers;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "C:\Users\PC\source\repos\50ti put URIS\src\Features\Blockcore.Features.Wallet\UI\Pages\Modal\ModalWalletRecover.razor"
using Blockcore.UI.BlazorModal;

#line default
#line hidden
#nullable disable
    public partial class ModalWalletRecover : Microsoft.AspNetCore.Components.ComponentBase
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
        }
        #pragma warning restore 1998
#nullable restore
#line 103 "C:\Users\PC\source\repos\50ti put URIS\src\Features\Blockcore.Features.Wallet\UI\Pages\Modal\ModalWalletRecover.razor"
       

    bool ShowForm { get; set; } = true;
    private void CloseModal()
    {
        ModalService.Close();
        NavigationManager.NavigateTo("walletview/" + WalletName + "/account 0");
        StateHasChanged();
    }

    public string WalletName { get; set; }
    public string Mnemonic { get; set; }
    private string Password { get; set; }
    private string Passphrase { get; set; }
    private List<string> Purposes { get; set; } = new List<string> { "Legacy", "Segwit" };
    private string SelectedPurpose { get; set; }
    private int Purpose { get; set; }
    string Alert { get; set; }
    private bool IsSubmitting { get; set; }
    private async Task callRecoverWallet()
    {
        IsSubmitting = true;
        StateHasChanged();
        await Task.Delay(1);  // flush changes
        await RecoverWallet();
        IsSubmitting = false;
        StateHasChanged();
        await Task.Delay(1);
    }
    private async Task RecoverWallet()
    {
        if (SelectedPurpose == "Legacy") Purpose = 44;
        if (SelectedPurpose == "Segwit") Purpose = 84;

        if (string.IsNullOrEmpty(this.Mnemonic)) { this.Alert = "Ensure that you have entered your Mnemonic"; return; }
        if (string.IsNullOrEmpty(this.WalletName)) { this.Alert = "Please enter a wallet name"; return; }
        if (string.IsNullOrEmpty(this.Password)) { this.Alert = "Please enter a password"; return; }
        if (this.Purpose != 44 && this.Purpose != 84) { this.Alert = "Select address format"; return; }
        if (this.Passphrase == null)
            this.Passphrase = string.Empty;
        this.Alert = string.Empty;
        var wallet = this.WalletManager.RecoverWallet(this.Password, this.WalletName, this.Mnemonic, this.DateTimeProvider.GetUtcNow(), passphrase: this.Passphrase, purpose: this.Purpose);
        this.Alert = "Your wallet has now been recovered.";
        ShowForm = false;
        await Task.CompletedTask;
    }

#line default
#line hidden
#nullable disable
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private ModalService ModalService { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IWalletSyncManager WalletSyncManager { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private Blockcore.Utilities.IDateTimeProvider DateTimeProvider { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IWalletManager WalletManager { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private NavigationManager NavigationManager { get; set; }
    }
}
#pragma warning restore 1591
